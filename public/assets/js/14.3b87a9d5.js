(window.webpackJsonp=window.webpackJsonp||[]).push([[14],{570:function(s,a,t){"use strict";t.r(a);var n=t(13),e=Object(n.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"es学习笔记"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#es学习笔记"}},[s._v("#")]),s._v(" ES学习笔记")]),s._v(" "),t("h3",{attrs:{id:"_1-搭建elk集群"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-搭建elk集群"}},[s._v("#")]),s._v(" 1.搭建ELK集群")]),s._v(" "),t("p",[s._v("后续补充")]),s._v(" "),t("h3",{attrs:{id:"_2-es基础"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-es基础"}},[s._v("#")]),s._v(" 2.ES基础")]),s._v(" "),t("h4",{attrs:{id:"_2-1-基本操作"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-基本操作"}},[s._v("#")]),s._v(" 2.1 基本操作")]),s._v(" "),t("p",[s._v("http的操作需要大写（PUT/GET/POST/DELETE/HEAD/OPTIONS）")]),s._v(" "),t("div",{staticClass:"language-url line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-url"}},[t("code",[t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 使用PUT向 dbindex/_doc/1中插入数据，指定id=1\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("PUT")]),s._v(' dbindex/_doc/1\n{\n  "name":"yim",\n  "age":25,\n  "actionTime": "2023-04-04",\n  "id":2,\n  "addr": "随便"\n}\n\n'),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 在 dbindex/_doc/中获取id=1的数据\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("GET")]),s._v(" dbindex/_doc/1\n\n"),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 使用GET在dbindex/_doc/中获取所有数据\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("GET")]),s._v(" dbindex/_doc/_search\n\n"),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 使用POST向 dbindex/_doc中插入数据，不用指定文档id\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("POST")]),s._v(' dbindex/_doc\n{\n  "name":"123"\n}\n\n'),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 使用POST修改文档，语法 POST dbindex/_doc/文档_id/_update\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("POST")]),s._v(' dbindex/_doc/yyhOSocB7VY9_-BPWtxj/_update\n{\n  "doc":{\n    "name":"223"\n  }\n}\n\n'),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" PUT执行修改操作时，会对文档的整个内容进行替换\n"),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" POST执行修改操作时，如果字段在文档中，则修改此字段的值；如果字段不在文档中，则把此字段加入文档信息中\n\n"),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 使用POST查询索引库中的所有数据\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("POST")]),s._v(" dbindex/_doc/_search\n\n"),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 使用DELTE删除dbindex/_doc中的文档\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("DELETE")]),s._v(" dbindex/_doc/某一_id\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br")])]),t("h4",{attrs:{id:"_2-2-使用get查询"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-使用get查询"}},[s._v("#")]),s._v(" 2.2 使用GET查询")]),s._v(" "),t("p",[s._v("常用的GET查询语句")]),s._v(" "),t("div",{staticClass:"language-url line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-url"}},[t("code",[t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 根据_id查询文档详情\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("GET")]),s._v(" 索引库名称/_doc/文档_id\n"),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 查询指定索引库中所有的文档信息\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("GET")]),s._v(" 索引库名称/_doc/_search\n"),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 查询当前集群中所有的别名索引库信息\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("GET")]),s._v(" /_cat/indices\n"),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 查询当前集群中所有的别名索引信息\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("GET")]),s._v(" /_cat/aliases\n"),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 查询当前集群的颜色信息\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("GET")]),s._v(" /_cat/health\n"),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 查询当前集群中主节点的信息\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("GET")]),s._v(" /_cat/master\n"),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 查询当前集群中从节点的信息\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("GET")]),s._v(" /_cat/node\n"),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 查询当前集群中索引分片的信息\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("GET")]),s._v(" /_cat/shards\n"),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 查询当前集群的健康状态\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("GET")]),s._v(" _cluster/health"),t("span",{pre:!0,attrs:{class:"token query"}},[t("span",{pre:!0,attrs:{class:"token query-delimiter"}},[s._v("?")]),t("span",{pre:!0,attrs:{class:"token pair"}},[t("span",{pre:!0,attrs:{class:"token key"}},[s._v("pretty")]),s._v("="),t("span",{pre:!0,attrs:{class:"token value"}},[s._v("true")])])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 查询当前集群的运行状态信息\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("GET")]),s._v(" _cluster/stats"),t("span",{pre:!0,attrs:{class:"token query"}},[t("span",{pre:!0,attrs:{class:"token query-delimiter"}},[s._v("?")]),t("span",{pre:!0,attrs:{class:"token pair"}},[t("span",{pre:!0,attrs:{class:"token key"}},[s._v("pretty")])])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 查询当前集群中所有节点的监控信息\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("GET")]),s._v(" _nodes/stats"),t("span",{pre:!0,attrs:{class:"token query"}},[t("span",{pre:!0,attrs:{class:"token query-delimiter"}},[s._v("?")]),t("span",{pre:!0,attrs:{class:"token pair"}},[t("span",{pre:!0,attrs:{class:"token key"}},[s._v("pretty")])])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token fragment"}},[t("span",{pre:!0,attrs:{class:"token fragment-delimiter"}},[s._v("#")])]),s._v(" 查询当前集群中所有索引的监控信息\n"),t("span",{pre:!0,attrs:{class:"token path"}},[s._v("GET")]),s._v(" _stats"),t("span",{pre:!0,attrs:{class:"token query"}},[t("span",{pre:!0,attrs:{class:"token query-delimiter"}},[s._v("?")]),t("span",{pre:!0,attrs:{class:"token pair"}},[t("span",{pre:!0,attrs:{class:"token key"}},[s._v("pretty")])])]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br")])]),t("p",[s._v("注：")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[s._v("集群的健康状态：\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"cluster_name"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"elasticsearch-cluster"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"status"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"green"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"timed_out"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("false")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"number_of_nodes"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"number_of_data_nodes"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"active_primary_shards"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"active_shards"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"relocating_shards"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"initializing_shards"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"unassigned_shards"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"delayed_unassigned_shards"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"number_of_pending_tasks"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"number_of_in_flight_fetch"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"task_max_waiting_in_queue_millis"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"active_shards_percent_as_number"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("100.0")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n参数：\nstatus：表示集群状态，green、yellow、red\nnumber_of_nodes/number_of_data_nodes：表示集群的节点数和数据节点数\nactive_primary_shards：表示集群中所有活跃的主分片数\nactive_shards：表示集群中所有活跃的分片数\nrelocating_shards：表示当前节点迁往其他节点的分片数量，通常为"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("，当有节点加入或者退出时该值会有相应变化\ninitializing_shards：表示正在初始化的分片\nunassigned_shards：表示未分配的分片数，通常为"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("。当有某个节点的副本分片丢失时，该值会相应的变化\nnumber_of_pending_tasks：表示主节点创建索引并分配了分片任务，如果该指标数值一直未减少，则代表集群存在不稳定因素，需要排除找到具体问题。而等待的任务只能由主节点进行处理，这些任务包括创建索引并将分片任务分配给节点\nactive_shards_percent_as_number：表示当前集群中分片的健康度（活跃分片数占总分片数的比例）\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br")])]),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[s._v("查询集群节点的监控信息\n参数：\nname：表示节点名称。\nroles：表示节点角色类型。\nindices.docs.count：表示索引文档总数量。\nsegments.count：表示集群中段（数据存储单位）的总数量。\njvm.heap_used_percent：表示内存的使用百分比。\nthread_pool."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("bulk"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("index"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("get"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("search"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("active"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("queue"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("rejectd"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("：表示线程池的一些信息\n主要指标有激活的(active)线程数，线程队列(queue)数和被拒绝(rejected)线程数量\n以下指标是累加值，当节点重启之后会清零：\nindices.indexing.index_total：表示索引文档数道。\nindices.indexing.index_time_in_millis：表示使用索引总耗时。\nindices.gt.total：表示get请求的数量。\nindices.get.time_in_millis：表示get请求总耗时。\nindices.scarch.query_total：表示search请求的总数。\nindices.search.query_time_in_milis：表示search求的总耗时。\nindices.search.fetch_total：表示fetch请求的总数量。\nindices.search.fetch_time_in_millis"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" 表示fetch请求的总耗时。\njvm.gc.collectors.young.collection count：表示年轻代垃圾回收次数。\njvm.ge.colleaors young.colection_time_in_millis"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("表示年轻代垃圾回收总耗时。\njvm.gc.collectors.old.collection_count：表示老年代垃圾回收次数。\njvm.ge.collectors old.collection_time_in_milis"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("表示老年代垃圾回收总耗时。\n\n需要计算的参数：\nindex_per_min：每分钟索引请求数量。计算公式如下：\n案引请求率=index_total（指标的两次采集差值）/系统时间差值 (ms) × "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("60000")]),s._v(" （公式"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("）\nindexAverge_per_min：索引请求处理延迟。计算公式如下：\n索引延迟率=index_time_in_millis（两次耗时的差值）/index_total (两次索引数量的差值) （公式"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("）\nget_per_min：表示每分钟get请求的数量，参照计算公式"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("。\ngetAverage_per_min：表示get请求的处理延迟率，参照计算公式"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("。\nmerge_per_min：表示每分钟merge请求的数量，参照计算公式"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("。\nmergeAverage_per_min：表示merge请求的处理延迟率，参照计算公式"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("。\nsearchQuery_per_min：表示每分钟query请求的数童，参照计算公式"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("。\nsearchQueryAverage_per_min：表示query请求的延迟率，参照计算公式"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("。\nsearchFetcb_per_min：表示每分钟fetch请求的数童，参照计算公式"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("。\nsearchFetchAverage_per_min：表示fetch请求的延迟率，参照计算公式"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("。\nyoungGc_per_min：表示每分钟young sc的数量，参照计算公式"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("。\nyoungGcAverage_per_min：表示母分钟young gC请求的延迟率，参照计算公式"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("。\noldGc_per_min：表示每分钟old gc的数量，参照计算公式"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("。\noldGcAverage_per_min：表示每分钟old gc请求的延迟率，参照计算公式"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("。\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br")])]),t("h4",{attrs:{id:"_2-3-es的映射"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-es的映射"}},[s._v("#")]),s._v(" 2.3 es的映射")]),s._v(" "),t("p",[s._v("映射是定义文档及其包含的字段如何存储在索引库中的过程。每个文档都是一个字段的集合，每个字段都有各自的数据类型，映射数据时，可以创建一个映射的定义，其中包含与文档相关字段的列表。映射定义还包括元数据字段（_source），他定义如何处理文档关联的元数据，而es支持动态映射和显式映射。每种方法根据不同的使用情况有不同的好处。如果要明确定义映射或者更好地控制创建字段和字段类型，则可以利用es的显示映射。动态映射和显式映射的详细说明如下")]),s._v(" "),t("ul",[t("li",[s._v("动态映射方便用户快速写入索引数据，es会根据写入的文档内容自动添加字段和字段类型，用户只负责写入具体的数据即可")]),s._v(" "),t("li",[s._v("显式映射需要用户精确地选择如何定义映射，例如哪些字符串字段应被视为全文字段，哪些字段是数字或者日期格式。显式索引是用于控制动态添加字段映射的自定义规则，而且在显示映射中使用runtime（运行时映射）时无需重新创建索引就可以更改数据存储的规则")])]),s._v(" "),t("h5",{attrs:{id:"_2-3-1-动态映射"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-1-动态映射"}},[s._v("#")]),s._v(" 2.3.1 动态映射")]),s._v(" "),t("p",[s._v("动态映射是es非常重要的功能之一，使用户不需要关注存储结果，能够在业务中尽快使用数据进行搜索。使用动态银蛇在写入索引文档数据时，不需要先创建索引和定义字段，索引中的字段和字段类型都将自动创建")]),s._v(" "),t("div",{staticClass:"language-url line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-url"}},[t("code",[t("span",{pre:!0,attrs:{class:"token path"}},[s._v("PUT")]),s._v(' datadb/_doc/1\n{"count": 10}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("以上语句创建了一个名为datadb的索引库，然后为此索引库添加count字段，该字段的数据类型是long，而long类型都是动态映射自动生成的。我们可以使用GET datadb语句进行查询。")]),s._v(" "),t("p",[s._v("elasticsearch在用户写入数据时检测到新的字段时，会动态地将该字段添加到类型映射中，由dynamic参数来控制此行为。用户可以通过将dynamic参数设置为true或明确指示elasticsearch根据传入的文档来动态创建字段。")]),s._v(" "),t("p",[s._v("映射规则")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("JSON数据类型")]),s._v(" "),t("th",[s._v('"dynamic":"ture"')]),s._v(" "),t("th",[s._v('"dynamic":"runtime"')])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("true或者false")]),s._v(" "),t("td",[s._v("boolean")]),s._v(" "),t("td",[s._v("boolean")])]),s._v(" "),t("tr",[t("td",[s._v("double类型")]),s._v(" "),t("td",[s._v("float")]),s._v(" "),t("td",[s._v("double")])]),s._v(" "),t("tr",[t("td",[s._v("integer类型")]),s._v(" "),t("td",[s._v("long")]),s._v(" "),t("td",[s._v("long")])]),s._v(" "),t("tr",[t("td",[s._v("object类型")]),s._v(" "),t("td",[s._v("object")]),s._v(" "),t("td",[s._v("object")])]),s._v(" "),t("tr",[t("td",[s._v("array类型")]),s._v(" "),t("td",[s._v("取决于数组的第一个元素值")]),s._v(" "),t("td",[s._v("取决于数组的第一个元素值")])]),s._v(" "),t("tr",[t("td",[s._v("日期类型")]),s._v(" "),t("td",[s._v("date")]),s._v(" "),t("td",[s._v("date")])]),s._v(" "),t("tr",[t("td",[s._v("数字类型")]),s._v(" "),t("td",[s._v("float或者long")]),s._v(" "),t("td",[s._v("double或者long")])]),s._v(" "),t("tr",[t("td",[s._v("日期和数字之外的类型")]),s._v(" "),t("td",[s._v("带有.keyword子字段的文本")]),s._v(" "),t("td",[s._v("keyword")])])])]),s._v(" "),t("h6",{attrs:{id:"_2-3-1-1-日期检测"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-1-1-日期检测"}},[s._v("#")]),s._v(" 2.3.1.1 日期检测")]),s._v(" "),t("h6",{attrs:{id:"_2-3-1-2-禁用日期检测"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-1-2-禁用日期检测"}},[s._v("#")]),s._v(" 2.3.1.2 禁用日期检测")]),s._v(" "),t("h6",{attrs:{id:"_2-3-1-3-自定义日期检测格式"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-1-3-自定义日期检测格式"}},[s._v("#")]),s._v(" 2.3.1.3 自定义日期检测格式")]),s._v(" "),t("h6",{attrs:{id:"_2-3-1-4-数字检测"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-1-4-数字检测"}},[s._v("#")]),s._v(" 2.3.1.4 数字检测")]),s._v(" "),t("h4",{attrs:{id:"_2-3-2-动态映射模板"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-2-动态映射模板"}},[s._v("#")]),s._v(" 2.3.2 动态映射模板")]),s._v(" "),t("p",[s._v("动态映射模板使得在默认的动态字段映射规则之外能够更好地控制es如何映射数据。用户可以通过将dynamic参数设置为true来启用动态映射模式，然后使用动态模板来定义自定义映射，这些映射可以根据匹配条件应用于动态添加的字段。相关参数如下")]),s._v(" "),t("ul",[t("li",[s._v("match_mapping_type：表示对es检测到的数据类型进行操作")]),s._v(" "),t("li",[s._v("match和unmatch：表示使用模式匹配来匹配字段名称")])]),s._v(" "),t("h3",{attrs:{id:"_3-es字段类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-es字段类型"}},[s._v("#")]),s._v(" 3.es字段类型")]),s._v(" "),t("p",[s._v("==常用类型==")]),s._v(" "),t("ul",[t("li",[s._v("binary：表示可以存储编码为base64的字符串或者二进制值")]),s._v(" "),t("li",[s._v("boolean：表示可以存储true和false的布尔值")]),s._v(" "),t("li",[s._v("keyword：该字段类型的数据再存储时不会进行分词处理，适合进行统计分析，不能进行全文搜索")]),s._v(" "),t("li",[s._v("numbers：用于表示数字类型，例如long和double")]),s._v(" "),t("li",[s._v("date：表示可以存储日期类型的数据")]),s._v(" "),t("li",[s._v("alias：表示为现有字段定义别名")]),s._v(" "),t("li",[s._v("text：该字段类型的数据再存储时会进行分词并建立索引，适合进行全文搜索，不能进行统计分析")])]),s._v(" "),t("p",[s._v("==对象和关系类型==")]),s._v(" "),t("ul",[t("li",[s._v("object：表示一个json对象")]),s._v(" "),t("li",[s._v("nested：嵌套类型，对象中可以嵌套对象")]),s._v(" "),t("li",[s._v("array：在es中，数组不需要专用的字段类型，默认情况下，任何字段都可以包含0个或多个值，但是数组中的所有值必须具有相同的字段类型")])]),s._v(" "),t("p",[s._v("==其余类型==")]),s._v(" "),t("ul",[t("li",[s._v("range：表示范围类型")]),s._v(" "),t("li",[s._v("rank_feature：表示排名类型")]),s._v(" "),t("li",[s._v("token_count：表示令牌计数类型")]),s._v(" "),t("li",[s._v("ip：用于ip地址的存储和查询的类型")]),s._v(" "),t("li",[s._v("geo_point，geo_shape：用于地理位置和空间位置存储和搜索的类型")])]),s._v(" "),t("h4",{attrs:{id:"_3-1-alias类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-alias类型"}},[s._v("#")]),s._v(" 3.1 alias类型")]),s._v(" "),t("div",{staticClass:"language-txt line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-txt"}},[t("code",[s._v('# 创建名为userinfo的索引库并为其创建映射关系\nPUT userinfo\n{\n\t"mappings":{\n\t\t"properties":{\n\t\t\t"age":{\n\t\t\t\t"type":"long"\n\t\t\t},\n\t\t\t"aliasage":{\n\t\t\t\t"type":"alias",\n\t\t\t\t"path":"age"\n\t\t\t},\n\t\t\t"transit_mode":{\n\t\t\t\t"type":"keyword"\n\t\t\t}\n\t\t}\n\t}\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("p",[s._v("以上语句创建了userinfo索引库，而且为age字段创建了名为aliasage的别名")]),s._v(" "),t("div",{staticClass:"language-txt line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-txt"}},[t("code",[s._v('# 在索引库userinfo中插入一条文档数据\nPUT userinfo/_doc/1\n{\n\t"age":39,\n\t"transit_mode":"transit_mode"\n}\n# 通过别名查询年龄大于30的用户信息\nGET userinfo/_doc/_search\n{\n\t"query":{\n\t\t"range":{\n\t\t\t"aliasage":{\n\t\t\t\t"gte": 30\n\t\t\t}\n\t\t}\n\t}\n}\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("p",[s._v("在使用别名的时候需要注意，可以使用别名进行数据的搜索，但是不能使用别名进行数据的写入")]),s._v(" "),t("h4",{attrs:{id:"_3-2-数组类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-数组类型"}},[s._v("#")]),s._v(" 3.2 数组类型")]),s._v(" "),t("p",[s._v("在es中，没有专用的数组数据类型。默认情况下，任何字段都可以包含0个或多个值，不过数组中的所有值必须具有相同的数据类型")]),s._v(" "),t("h4",{attrs:{id:"_3-3-binary类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-binary类型"}},[s._v("#")]),s._v(" 3.3 binary类型")]),s._v(" "),t("p",[s._v("binary定义的字段类型可以存储编码为Base64的字符串或者二进制值")]),s._v(" "),t("h4",{attrs:{id:"_3-4-布尔类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-布尔类型"}},[s._v("#")]),s._v(" 3.4 布尔类型")]),s._v(" "),t("h4",{attrs:{id:"_3-5-日期类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-5-日期类型"}},[s._v("#")]),s._v(" 3.5 日期类型")]),s._v(" "),t("h4",{attrs:{id:"_3-6-nested类型"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-6-nested类型"}},[s._v("#")]),s._v(" 3.6 nested类型")])])}),[],!1,null,null,null);a.default=e.exports}}]);